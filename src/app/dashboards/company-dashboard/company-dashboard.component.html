<div class="dashboard_client">
  <h1>Bienvenue sur votre espace professionel</h1>
  <div class="tabs">
    <button
      (click)="activeTab = 'inscriptions'"
      [class.active]="activeTab === 'inscriptions'"
    >
      Inscriptions
    </button>
    <button
      (click)="activeTab = 'Liens privés'"
      [class.active]="activeTab === 'Liens privés'"
    >
      Liens privés
    </button>

    <button
      (click)="activeTab = 'demandeDevis'"
      [class.active]="activeTab === 'demandeDevis'"
    >
      Demande de devis
    </button>

  </div>

  <div *ngIf="activeTab === 'inscriptions'" class="tab-content">
    <h2>Mes inscriptions</h2>
    @if (inscriptions.length > 0) {
    <table>
      <thead>
      <tr>
        <th>Détails</th>
        <th>Type</th>
        <th>Statut</th>
        <th>Liens privés pour s'inscrire</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let inscription of inscriptions">
        <td>
          <div style="text-align:left;" *ngIf="inscription.stage; else loading">
            <strong>Ville :</strong> {{ inscription.stage.city }} <br>
            <strong>Arrondissement :</strong> {{ inscription.stage.arrondissement }} <br>
            <strong>Date :</strong> {{ inscription.stage.dateDebut | date:'d':'fr' }} & {{ inscription.stage.dateFin | date:'d MMMM yyyy':'fr' }}
            <strong>Rue :</strong> {{ inscription.stage.street }} <br>
            <strong>Organisation :</strong> {{ inscription.stage.organisation }}<br>
            <strong>Prix :</strong> {{ inscription.stage.price | currency:'EUR' }}
          </div>
          <ng-template #loading>
            <span>Chargement...</span>
          </ng-template>
        </td>
        <td>{{ inscription.stageType }}</td>
        <td>{{ inscription.inscriptionStatut | inscriptionStatut}}</td>
        <td>

          <!--<button
            (click)="onDeleteInscription(inscription.id)"
            class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-xl shadow-md transition duration-200 ease-in-out flex items-center gap-2"
          >
            &lt;!&ndash; <svg
               xmlns="http://www.w3.org/2000/svg"
               class="h-1 w-1"
               fill="none"
               viewBox="0 0 24 24"
               stroke="currentColor"
               stroke-width="2"
             >
               <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
             </svg>&ndash;&gt;
            <i class="fas fa-trash-alt"></i>
            Supprimer
          </button>-->
        </td>
      </tr>
      </tbody>
    </table>
    }
    @else{
      <ng-template #noInscriptions>
        <p>Aucune inscription trouvée.</p>
      </ng-template>
    }
  </div>
</div>

<div *ngIf="activeTab === 'Liens privés'" class="tab-content">
  @if (privateLinks.length > 0) {

    <table id="private_links_table">
      <thead>
      <tr>
        <th>Stage</th>
        <th>Token</th>
        <th>Date d'expiration</th>
      </tr>
      </thead>

      @for(privateLink of privateLinks; track privateLink.id){
        <tr>
          <td>{{privateLink.stageId}}</td>
          <td>
        <div class="token-container">
          <input
            [type]="isTokenVisible ? 'text' : 'password'"
            [value]="privateLink.token"
            readonly
            class="token-input"
          />
          <button (click)="toggleTokenVisibility()" class="eye-icon">
            <i [ngClass]="isTokenVisible ? 'fas fa-eye-slash' : 'fas fa-eye'"></i>
          </button>
        </div>
          </td>

        <td>{{privateLink.expirationDate | date:'d MMMM yyyy':'fr'}}</td>
        </tr>
          }
    </table>

    }

    @else{
      <ng-template #loading>
        <span>Pas de lien privé</span>
      </ng-template>
    }
    </div>
    <div *ngIf="activeTab === 'demandeDevis'" class="tab-content">
      <app-demande-devis></app-demande-devis>
    <div>
  </div>
</div>
