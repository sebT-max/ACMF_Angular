<div class="inscription-container">
  <!-- Détails du stage -->
  <div id="inscription_container_details" class="stage-details" *ngIf="stageDetails">
    <div class="details-wrapper">
      <h2>Stage à {{ stageDetails.city }}</h2>
      <p>{{ stageDetails.arrondissement }} arrondissement</p>
      <p>{{ stageDetails.street }}</p>
      <p>{{ stageDetails.dateDebut | date:'d':'fr' }} & {{ stageDetails.dateFin | date:'d MMMM yyyy':'fr' }}</p>
      <p>Prix: {{ stageDetails.price }}€</p>
    </div>
    <div class="consignes_container">
      <h3><span class="icon">⚠️ </span>  <strong> &nbsp; &nbsp;Consignes à respecter !</strong></h3>

      <div class="form-text text-muted format">
        <ul>
          <li>Formats acceptés pour les images : JPEG, PNG.</li>
          <li>La lettre 48N doit être en PDF.</li>
        </ul>
      </div>
      <h4>Veuillez intituler vos fichiers de la manière suivante:</h4>
      <ul>
        <h4>-> Permis de conduire:</h4>
        <li>recto: "(nom_prénom)_permis_recto"</li>
        <li>verso: "(nom_prénom)_permis_verso"</li>
      </ul>
      <ul>
        <h4>-> Papiers d'identité:</h4>
        <li>recto: "(nom_prénom)_identité_recto"</li>
        <li>verso: "(nom_prénom)_identité_verso"</li>
      </ul>
    </div>
  </div>

  <!-- Formulaire d'inscription -->
  <div id="inscription_container_form">
    <form id="inscription_form" [formGroup]="inscriptionCreationForm" (ngSubmit)="handleInscription()">
      <label for="stageType">Type de Stage*</label>
      <select id="stageType" formControlName="stageType">
        <option value="" disabled selected>Sélectionner un type de stage</option>
        <option *ngFor="let type of stageTypes" [value]="type.value">
          {{ type.label }}
        </option>
      </select>
      <br>

      <div id="inscription_form_files">
        <!-- Permis -->
        <div class="file-upload-section">
          <label for="permis"><strong>Permis (recto+verso)</strong></label>
          <p-fileUpload
            name="permis"
            [customUpload]="true"
            (uploadHandler)="uploadFiles($event)"
            (onSelect)="onFilesChange($event, 'permis')"
            (onRemove)="onRemoveFile($event, 'permis')"
            [multiple]="true"
            [showUploadButton]="false"
            [showCancelButton]="false"
            accept=".pdf,image/*"
            chooseLabel="Choisir les fichiers"
            mode="advanced"
            [maxFileSize]="5000000"
          ></p-fileUpload>
        </div>

        <!-- Carte d'identité -->
        <div class="file-upload-section">
          <label for="carteId"><strong>Carte Id (recto+verso)</strong></label>
          <p-fileUpload
            name="carteId"
            [customUpload]="true"
            (uploadHandler)="uploadFiles($event)"
            (onSelect)="onFilesChange($event, 'carteId')"
            (onRemove)="onRemoveFile($event, 'carteId')"
            [multiple]="true"
            [showUploadButton]="false"
            [showCancelButton]="false"
            accept=".pdf,image/*"
            chooseLabel="Choisir les fichiers"
            mode="advanced"
            [maxFileSize]="5000000"
          ></p-fileUpload>
        </div>

        <!-- Lettre 48N -->
        <div *ngIf="selectedStageLabel === 'Tribunal'" class="file-upload-section">
          <label for="lettre48n"><strong>Lettre 48N (pdf)</strong></label>
          <p-fileUpload
            name="lettre48n"
            [customUpload]="true"
            (uploadHandler)="uploadFiles($event)"
            (onSelect)="onFilesChange($event, 'lettre48n')"
            (onRemove)="onRemoveFile($event, 'lettre48n')"
            [multiple]="true"
            [showUploadButton]="false"
            [showCancelButton]="false"
            accept=".pdf,image/*"
            chooseLabel="Chargez lettre_48N"
            mode="advanced"
            [maxFileSize]="5000000"
          ></p-fileUpload>
        </div>
      </div>

      <br>

      <!-- Affichage des erreurs -->
      <div *ngIf="lettre48nError" class="error-message">
        {{ lettre48nError }}
      </div>

      <!-- Champ Code Promo -->
      <input id="codePromo" formControlName="codePromo" placeholder="Code Promo (optionnel)" />
      <br>

      <!-- Bouton de soumission -->
      <button type="submit" [disabled]="inscriptionCreationForm.invalid || isLoading" class="submit-button">
        <ng-container *ngIf="isLoading">
          <span class="spinner-inline"></span>
          <span>Chargement...</span>
        </ng-container>
        <ng-container *ngIf="!isLoading">
          Valider l'inscription
        </ng-container>
      </button>
    </form>
  </div>
</div>
